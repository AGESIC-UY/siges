<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ace="http://www.icefaces.org/icefaces/components"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:icecore="http://www.icefaces.org/icefaces/core"
                xmlns:ice="http://www.icesoft.com/icefaces/component">

    <ice:panelGroup id="panelParticipantes" 
                    style="#{fichaMB.selectedMostrar == 6 ? 'width: 100%; padding-right:25px' : ''}" 
                    styleClass="col-sm-6 cuadro" 
                    rendered="#{inicioMB.verDos and (fichaMB.selectedMostrar == null || fichaMB.selectedMostrar == 6) and fichaMB.fieldRendered('panelInteresados')}">

        <ice:panelGroup id="cabezalParticipantes" styleClass="cabezal">
            <ice:outputText value="#{labels.participantes}"/>
            <ace:pushButton value="" action="#{fichaMB.miMostrar(6)}" 
                            styleClass="#{fichaMB.selectedMostrar == 6 ? 'botonMinimizar' : 'botonAgregar'} iconoTabla"/>
        </ice:panelGroup>

        <!--El panel con el resumen de participantes -->
        <ice:panelGroup  styleClass="cuerpo" rendered="#{not fichaMB.mostrar[6]}">
            <ace:dataTable id="participantesTable"
                           value="#{fichaMB.fichaTO.participantes}"
                           styleClass="tablaFicha no-margin"
                           var="part"
                           rendered="#{not empty fichaMB.fichaTO.participantes}"
                           paginator="true"
                           paginatorPosition="bottom"
                           rows="10">
                <ace:column id="id_int">
                    <h:outputText id="idCell" value="#{part.partUsuarioFk != null ?  part.partUsuarioFk.usuNombreApellido : ''}"/>
                </ace:column>
                
                <ace:column headerText="#{labels.carga_hs_horas_totales}">
                    <!--
                    <h:outputText value="# {part.partUsuarioFk}"/>
                    -->
                </ace:column>
                
                <ace:column headerText="#{labels.carga_hs_pendientes}">
                    <!--
                    <h:outputText value="# {part.partUsuarioFk}"/>
                    -->
                </ace:column>
            </ace:dataTable>

            <ice:panelGroup rendered="#{empty fichaMB.fichaTO.participantes}">
                <ice:outputText value="Sin Participantes" />
            </ice:panelGroup>

        </ice:panelGroup>

        <!--El panel con el modulo Participantes -->
        <ice:panelGroup rendered="#{fichaMB.mostrar[6]}" styleClass="cuerpo">

            <!-- Formulario de alta -->
            <ice:panelGroup id="participantesForm">
                <ice:panelCollapsible expanded="#{fichaMB.partFormDataExpanded}">
                    <f:facet name="header">
                        <h:panelGrid columns="1">
                            <h:commandButton value="#{fichaMB.participante.partPk ne null ? labels.editarParticipante : labels.agregarParticipante}" 
                                             rendered="#{!fichaMB.partFormDataExpanded and fichaMB.fieldRendered('agregarParticipante')}"
                                             styleClass="boton principal #{fichaMB.participante.partPk ne null ? 'editar' : 'agregar'}" />
                        </h:panelGrid>
                    </f:facet>

                    <ice:panelGroup id="participantesFormData">
                        <ice:panelGrid  styleClass="formulario " columns="4">

                            <ice:outputLabel value="#{labels.usuario}"/>
                            <ice:selectOneMenu id="comboUsuario"
                                               value="#{fichaMB.participante.partUsuarioFk.usuId}">
                                <f:selectItems value="#{fichaMB.listaUsuarios}" var="usu" 
                                               itemLabel="#{usu.nombreApellido}" itemValue="#{usu.usuId}"/>
                            </ice:selectOneMenu>

                            <ice:outputLabel value="" />
                            <ice:outputText value="" />
                        </ice:panelGrid>

                    </ice:panelGroup> 
                    <ice:panelGroup styleClass="panelBotones">
                        <ace:messages id="participantesMsg"/>
                        <ace:pushButton value="#{fichaMB.participante.partPk ne null ? labels.editarParticipante : labels.agregarParticipante}" 
                                        styleClass="boton principal"
                                        action="#{fichaMB.agregarParticipanteAction()}"/>
                        <ace:linkButton  value="#{labels.cerrar}" styleClass="boton secundario" 
                                         action="#{fichaMB.cerrarFormCollapsable()}"/>
                    </ice:panelGroup>
                </ice:panelCollapsible>
            </ice:panelGroup>

            <!-- Lista de participantes-->
            <ice:panelGroup id="participantesList" styleClass="resultado recuadro">
                <ice:panelGrid rendered="#{not empty fichaMB.fichaTO.participantes}" width="100%" >
                    <ace:dataTable id="tblResultados1" 
                                   value="#{fichaMB.fichaTO.participantes}" var="part"
                                   paginator="true" pageCount="5" 
                                   rows="#{configuracionMB.cantElementosPorPagina}">
                        <ace:column headerText="#{labels.inicio_col_Nombre}" >
                            <h:outputText value="#{part.partUsuarioFk != null ?  part.partUsuarioFk.usuNombreApellido : ''}"/>
                        </ace:column>

                        <ace:column headerText="#{labels.hCorreo}">
                            <h:outputText value="#{part.partUsuarioFk != null ?  part.partUsuarioFk.usuCorreoElectronico : ''}"/>
                        </ace:column>

                        <ace:column styleClass="columnaBoton">
                            <ace:pushButton id="btnRevisarHoras" 
                                            styleClass="botonEditar iconoTabla" 
                                            action="#{fichaMB.revisarHorasAction(part.partPk)}"/>
                        </ace:column>

                        <ace:column styleClass="columnaBoton"
                                    rendered="#{fichaMB.fieldRendered('eliminarParticipante')}">
                            <h:commandButton id="btnEliminarParticipante"
                                             styleClass="botonEliminar iconoTabla" 
                                             title="#{labels.eliminarTooltip}"
                                             onclick="confirmationEliminarPart#{part.partPk}.show();" />
                            <ace:confirmationDialog widgetVar="confirmationEliminarPart#{part.partPk}" 
                                                    message="#{labels.confirmacionEliminacion}"
                                                    header="#{labels.hConfirmacion}"
                                                    closable="true"
                                                    closeOnEscape="true"
                                                    severity="info"
                                                    modal="true"
                                                    position="center">
                                <h:panelGrid columns="2" styleClass="centeredPanelGrid">
                                    <h:commandButton id="yesDelPart"
                                                     value="#{labels.si}"
                                                     styleClass="boton principal botonContinuar"
                                                     onclick="confirmationEliminarPart#{part.partPk}.hide();" 
                                                     actionListener="#{fichaMB.eliminarParticipanteAction(part.partPk)}"/>
                                    <h:commandButton id="noDelPart"
                                                     value="#{labels.no}"
                                                     styleClass="boton principal botonEliminar"
                                                     onclick="confirmationEliminarPart#{part.partPk}.hide();"  />
                                </h:panelGrid>
                            </ace:confirmationDialog>
                        </ace:column>
                    </ace:dataTable>
                </ice:panelGrid>
                <ice:panelGrid rendered="#{empty fichaMB.fichaTO.participantes}" width="100%">
                    <ice:outputText value="#{labels.noHayParticipantes}"/>
                </ice:panelGrid>

            </ice:panelGroup>

        </ice:panelGroup>
    </ice:panelGroup>
</ui:composition>